(function(e){function t(t){for(var i,r,n=t[0],l=t[1],c=t[2],u=0,p=[];u<n.length;u++)r=n[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);d&&d(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],i=!0,n=1;n<a.length;n++){var l=a[n];0!==o[l]&&(i=!1)}i&&(s.splice(t--,1),e=r(r.s=a[0]))}return e}var i={},o={app:0},s=[];function r(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=i,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(a,i,function(t){return e[t]}.bind(null,i));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var d=l;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"1bae":function(e,t,a){},"3cd0":function(e,t,a){},"4fde":function(e,t,a){"use strict";var i=a("7ce0"),o=a.n(i);o.a},"73f3":function(e,t,a){"use strict";var i=a("9e5d"),o=a.n(i);o.a},"7ce0":function(e,t,a){},"9cff":function(e,t,a){},"9e5d":function(e,t,a){},c0f7:function(e,t,a){"use strict";var i=a("9cff"),o=a.n(i);o.a},c819:function(e,t,a){"use strict";var i=a("1bae"),o=a.n(i);o.a},cd49:function(e,t,a){"use strict";a.r(t);a("d3b7"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var i,o,s=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},n=[],l={data:function(){return{}},methods:{},components:{}},c=l,d=a("2877"),u=Object(d["a"])(c,r,n,!1,null,null,null),p=u.exports,h=a("8c4f"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"main"}},[a("div",{attrs:{id:"mynav"}},[a("mynav")],1),a("el-container",{staticStyle:{border:"1px solid #eee",background:"white"}},[a("el-aside",{attrs:{width:"18vh"}},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"background-color":"rgb(238, 241, 246)","default-active":"2"}},[a("el-menu-item",{on:{click:function(t){return e.getFile(0)}}},[a("i",{staticClass:"el-icon-menu"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("全部文件")])]),a("el-menu-item",{on:{click:function(t){return e.getByType("img")}}},[a("i",{staticClass:"el-icon-picture-outline"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("图片")])]),a("el-menu-item",{on:{click:function(t){return e.getByType("document")}}},[a("i",{staticClass:"el-icon-document"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("文档")])]),a("el-menu-item",{on:{click:function(t){return e.getByType("video")}}},[a("i",{staticClass:"el-icon-setting"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("视频")])]),a("el-menu-item",{on:{click:e.getDelete}},[a("i",{staticClass:"el-icon-headset"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("回收站")])])],1),a("div",{attrs:{id:"progress"}},[a("el-progress",{attrs:{percentage:this.percentage}}),a("p",[e._v(e._s(this.percentageNow)+"/"+e._s(this.percentageMax))])],1)],1),a("el-container",{staticStyle:{height:"93vh"}},[a("el-header",{staticStyle:{height:"80px"}},[a("el-upload",{staticStyle:{display:"inline-block"},attrs:{action:"http://39.108.108.227:9527/cd/file/upload",headers:e.headers,multiple:"","on-progress":e.showProgress,"on-success":e.reload,"show-file-list":!1,data:{directory_id:[].concat(this.$store.state.fileposition).pop()}}},[a("el-button",{staticStyle:{margin:"10px 10px 0 0"},attrs:{type:"primary"}},[a("i",{staticClass:"fa fa-upload fa-lg",staticStyle:{"margin-right":"10px"}}),e._v("上传")])],1),a("button",{staticClass:"primary-button",on:{click:e.AddFolder}},[a("i",{staticClass:"fa fa-plus fa-lg",staticStyle:{"margin-right":"10px"}}),e._v("新建文件夹")]),a("button",{staticClass:"primary-button",on:{click:function(t){return e.handleDownload()}}},[a("i",{staticClass:"fa fa-download fa-lg",staticStyle:{"margin-right":"10px"}}),e._v("下载")]),a("div",{attrs:{id:"file-position"}},["0"!=this.$store.state.fileposition[this.$store.state.fileposition.length-1]?a("span",{attrs:{id:"return"},on:{click:function(t){return e.pageReturn()}}},[e._v("返回上一级")]):e._e(),"0"!=this.$store.state.fileposition[this.$store.state.fileposition.length-1]?a("span",[e._v("|")]):e._e(),a("span",{on:{click:function(t){return e.pageReturnAll()}}},[e._v("全部文件")])])],1),a("el-main",[a("mainrow",{attrs:{getFile:this.getFile}})],1)],1)],1),this.listShow?a("div",{attrs:{id:"uploadList"}},[a("div",{attrs:{id:"listHead"}},[a("span",{on:{click:e.showList}},[e._v("上传列表")]),a("a",{on:{click:e.showList}},[a("i",{staticClass:"fa fa-minus "})]),a("a",{on:{click:function(t){e.listShow=!e.listShow}}},[a("i",{staticClass:"fa fa-times "})])]),a("div",{attrs:{id:"listBody"}},[a("el-table",{attrs:{data:this.uploadfiles,fit:"","show-header":"","empty-text":"暂无文件"}},[a("el-table-column",{attrs:{prop:"name",label:"文件名"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.getStatus(t.row.percentage)?a("el-progress",{attrs:{percentage:Math.floor(t.row.percentage)}}):a("i",{staticClass:"fa fa-check-circle fa-2x",staticStyle:{color:"#5CD992"}})]}}],null,!1,3523481877)})],1)],1)]):e._e()],1)},m=[],g=(a("99af"),a("b0c0"),a("96cf"),a("1da1")),v=a("2909"),w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{data:this.$store.state.data,fit:"","show-header":"","empty-text":"暂无文件","max-height":"830px"},on:{"cell-click":e.showrow,"cell-mouse-enter":e.MouseEnter,"cell-mouse-leave":e.MouseLeave,select:e.SelectHandle,"select-all":e.SelectAll}},[a("el-table-column",{staticClass:"checkbox",attrs:{type:"selection",width:"30","min-width":"0.5"}}),a("el-table-column",{attrs:{prop:"name",label:"文件名","min-width":"4.5"},scopedSlots:e._u([{key:"default",fn:function(t){return[void 0!=t.row.type||t.row.edit?e._e():a("i",{staticClass:"fa fa-folder fa-2x",staticStyle:{color:"#FFD659"},attrs:{"aria-hidden":"true"}}),"image"!=t.row.type||t.row.edit?e._e():a("i",{staticClass:"fa fa-file-image-o fa-2x",staticStyle:{color:"#FF7743"},attrs:{"aria-hidden":"true"}}),"document"!=t.row.type||t.row.edit?e._e():a("i",{staticClass:"fa fa-file-word-o fa-2x",staticStyle:{color:"#4D97FF"},attrs:{"aria-hidden":"true"}}),"video"!=t.row.type||t.row.edit?e._e():a("i",{staticClass:"fa fa-file-video-o fa-2x",staticStyle:{color:"#8183F1"},attrs:{"aria-hidden":"true"}}),"other"!=t.row.type||t.row.edit?e._e():a("i",{staticClass:"fa fa-file-archive-o fa-2x",staticStyle:{color:"#8183F1"},attrs:{"aria-hidden":"true"}}),t.row.edit?[a("el-input",{staticClass:"edit-input",attrs:{size:"small"},model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})]:a("span",{attrs:{id:"filename"}},[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{"min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.edit,expression:"scope.row.edit"}],attrs:{type:"success",circle:"",size:"small",icon:"el-icon-check"},on:{click:function(a){return e.handleSave(t.$index,t.row)}}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.edit,expression:"scope.row.edit"}],attrs:{type:"danger",circle:"",size:"small",icon:"el-icon-close"},on:{click:function(a){return e.handleCancel(t.$index,t.row)}}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.row.edit&&t.row.hover,expression:"!scope.row.edit&&scope.row.hover"}],attrs:{type:"primary",circle:"",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.row.edit&&t.row.hover,expression:"!scope.row.edit&&scope.row.hover"}],attrs:{type:"primary",circle:"",size:"small",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.row.edit&&t.row.hover,expression:"!scope.row.edit&&scope.row.hover"}],attrs:{type:"primary",circle:"",size:"small",icon:"el-icon-share"},on:{click:function(a){return e.handleShare(t.$index,t.row)}}})]}}])}),a("el-table-column",{attrs:{prop:"size",label:"大小","min-width":"1"}}),a("el-table-column",{attrs:{prop:"createtime",label:"修改时间","min-width":"2"}})],1)},b=[],y={data:function(){return{show:!1,editClick:!1,api:"http://39.108.108.227:9527/"}},props:{getFile:Function},methods:{showrow:function(e,t){"文件名"==t.label&&1==this.$store.state.allowClick&&(void 0==e.type&&(this.getFile(e.id),this.$store.state.fileposition.push(e.id),console.log("发送请求")),console.log(e.type))},MouseEnter:function(e){1==this.$store.state.allowHover&&(e.hover=!0)},MouseLeave:function(e){e.hover=!1},SelectHandle:function(e,t){this.$store.state.selection=e,console.log(this.$store.state.selection)},SelectAll:function(e){this.$store.state.selection=e,console.log(this.$store.state.selection)},handleEdit:function(e,t){this.$store.state.Formername=t.name,this.editClick=!0,t.edit=!t.edit,this.$store.state.allowClick=!1,this.$store.state.allowHover=!1},handleDelete:function(e,t){var a=this,i=this.api+"cd/file/delete/",o=this.api+"cd/directory/delete/";this.$confirm("此操作将永久删除文件，是否继续","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){void 0==t.type?a.deleteFile(o,t.id):a.deleteFile(i,t.id)})).catch((function(e){a.$message({type:"info",message:"cancel"===e?"取消删除":"返回"})}))},handleShare:function(e,t){var a=this;this.$axios({url:this.api+"cd/share/createUrl",method:"post",data:{fileIdList:[t.id],day:7}}).then((function(e){var t=e.data.data;a.$confirm("分享链接："+t,"确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"复制链接",cancelButtonText:"关闭"}).then((function(e){a.$message({type:"info",message:e})}))}))},handleSave:function(e,t){this.editClick?""==t.name?(t.name=this.$store.state.Formername,this.$message({message:"文件名不能为空",type:"success"})):(this.renameFile(t.id,t.name,t.type,t.parent_id,t.directory_id),this.$message({message:"文件名已经成功修改",type:"success"})):this.createFile(t.name),t.edit=!1,this.editClick=!1,this.$store.state.allowClick=!0,this.$store.state.allowHover=!0},handleCancel:function(e,t){t.edit=!1,this.$store.state.allowClick=!0,this.$store.state.allowHover=!0,this.editClick?(t.name=this.$store.state.Formername,this.$message({message:"重命名已取消",type:"success"}),this.editClick=!1):this.$store.state.data.pop()},createFile:function(e){var t=this;console.log(e),this.$axios({url:this.api+"cd/directory/create",method:"post",data:{name:e,parent_id:Object(v["a"])(this.$store.state.fileposition).pop()}}).then((function(e){t.getFile(Object(v["a"])(t.$store.state.fileposition).pop())}))},deleteFile:function(e,t){var a=this;this.$axios({url:e+t,methods:"get"}).then((function(e){a.$message({message:e.data.message,type:e.data.success}),a.getFile(Object(v["a"])(a.$store.state.fileposition).pop())}))},renameFile:function(e,t,a,i,o){var s=this.api+"cd/file/update",r=this.api+"cd/directory/update";void 0==a?this.$axios({url:r,method:"post",data:{id:e,name:t,parent_id:i}}).then((function(e){console.log(e)})):this.$axios({url:s,method:"post",data:{id:e,name:t,directory_id:o}}).then((function(e){console.log(e)}))}}},$=y,x=(a("73f3"),Object(d["a"])($,w,b,!1,null,null,null)),k=x.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"nav"}},[a("el-menu",{staticClass:"el-menu-demo",attrs:{mode:"horizontal",router:""}},[a("el-menu-item",{attrs:{index:"/",id:"firstnav"}},[e._v("网盘")]),a("el-menu-item",{on:{click:e.forgetPassWord}},[e._v("动态")]),a("el-menu-item",{on:{click:e.forgetPassWord}},[e._v("分享")]),a("el-submenu",{attrs:{index:"3",id:"login"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-s-custom"}),e._v(e._s(e.username))]),a("el-menu-item",{on:{click:e.logOut}},[e._v("注销")]),a("el-menu-item",{attrs:{index:"2-2"}},[e._v("更改密码")]),a("el-menu-item",{attrs:{index:"2-3"}},[e._v("选项3")])],2),a("el-menu-item",{attrs:{id:"search"},on:{click:e.searchHandle}},[a("i",{staticClass:"el-icon-search"}),e._v("搜索 ")]),a("div",{attrs:{id:"input"}},[a("el-input",{attrs:{id:"search-input",placeholder:"请输入内容"},model:{value:e.searchInput,callback:function(t){e.searchInput=t},expression:"searchInput"}})],1)],1)],1)},L=[],_={name:"mynav",data:function(){return{searchInput:"",username:"",api:"http://39.108.108.227:9527/"}},methods:{forgetPassWord:function(){this.$message({message:"此功能暂未开放",type:"warning"})},logOut:function(){var e=this;this.$confirm("是否退出登录","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){e.$axios({url:e.api+"cd/user/logout",method:"get"}),localStorage.removeItem("token"),e.$router.push("/")})).catch((function(e){}))},getUsername:function(){var e=this;this.$axios({url:this.api+"cd/user/getUsername",method:"get"}).then((function(t){e.username=t.data.data}))},searchHandle:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=[],t.next=3,e.$axios({url:e.api+"cd/search/directory/?key="+e.searchInput,method:"get"}).then((function(e){console.log(e.data.data),e.data.data&&(a=e.data.data)}));case 3:return t.next=5,e.$axios({url:e.api+"cd/search/files/?key="+e.searchInput,method:"get"}).then((function(t){console.log(t.data.data),t.data.data&&(e.$store.state.data=a.concat(t.data.data)),e.$store.commit("addKey")}));case 5:case"end":return t.stop()}}),t)})))()}},created:function(){this.getUsername()}},S=_,R=(a("c819"),Object(d["a"])(S,C,L,!1,null,null,null)),F=R.exports,O={data:function(){var e=JSON.parse(localStorage.getItem("token"));return{uploadfiles:[],listShow:!1,listHide:!1,api:"http://39.108.108.227:9527/",headers:{token:e.data},percentageMax:1,percentageNow:0,percentage:0}},components:{mainrow:k,mynav:F},methods:{pageReturn:function(){this.$store.state.fileposition.pop();var e=this.$store.state.fileposition[this.$store.state.fileposition.length-1];this.getFile(e)},pageReturnAll:function(){this.$store.state.fileposition=[0],this.getFile(0)},AddFolder:function(){this.$store.state.allowClick&&(this.$store.state.data.push({name:"新建文件夹",size:"-",date:this.getDate(),edit:!0,hover:!1}),this.$store.state.Formername="新建文件夹",this.$store.state.allowClick=!1,this.$store.state.allowHover=!1)},getDate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate();a<=9&&(a="0"+a),i<=9&&(i="0"+i);var o=t+"-"+a+"-"+i;return o},showProgress:function(e,t,a){console.log(t.percentage),this.uploadfiles=a,this.listShow=!0,100==t.percentage&&this.getFile(Object(v["a"])(this.$store.state.fileposition).pop())},getFile:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=[],a.next=3,t.$axios({url:t.api+"cd/directory/getFiles/"+e,method:"get"}).then((function(e){e.data.data&&(i=e.data.data)}));case 3:return a.next=5,t.$axios({url:t.api+"cd/file/getFiles/"+e,method:"get"}).then((function(e){e.data.data&&(t.$store.state.data=i.concat(e.data.data)),t.$store.commit("addKey")}));case 5:case"end":return a.stop()}}),a)})))()},handleDownload:function(){var e=this.$store.state.selection;if(console.log(e),e!=[])for(var t in e)console.log(e[t].name),this.downloadFile(e[t].id,e[t].name)},downloadFile:function(e,t){var a=document.createElement("a"),i=this.api+"cd/file/download/"+e;a.setAttribute("href",i),a.setAttribute("download",t),a.click()},reload:function(e,t,a){this.getFile(Object(v["a"])(this.$store.state.fileposition).pop()),this.getPercent()},getPercent:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios({url:e.api+"cd/file/getAllSpace",method:"get"}).then((function(t){e.percentageMax=t.data.data,console.log(e.percentageMax)}));case 2:return t.next=4,e.$axios({url:e.api+"cd/file/getUsedSpace",method:"get"}).then((function(t){e.percentageNow=t.data.data,console.log(e.percentageNow)}));case 4:e.percentage=Math.ceil(e.percentageNow/e.percentageMax*100),e.percentageMax=e.percentageMax/1024/1024+"M",e.percentageNow=Math.ceil(e.percentageNow/1024)+"K";case 7:case"end":return t.stop()}}),t)})))()},getStatus:function(e){return!(100==e)},showList:function(){var e=document.getElementById("uploadList");this.listHide=!this.listHide,this.listHide?e.style.height="65px":e.style.height="5.333333rem"},getDelete:function(){var e=this,t=[];this.$axios({url:this.api+"cd/directory/getDelete",method:"get"}).then((function(a){a.data.data&&(t=a.data.data),e.$axios({url:e.api+"cd/file/getDelete",method:"get"}).then((function(a){a.data.data&&(e.$store.state.data=t.concat(a.data.data),e.$store.commit("addKey"))}))}))},getByType:function(e){var t=this;this.$axios({url:this.api+"cd/file/getByType",method:"get",params:{type:e}}).then((function(e){t.$store.state.data=e.data.data,t.$store.commit("addKey")}))}},created:function(){this.getFile(0),this.getPercent()}},I=O,M=(a("c0f7"),Object(d["a"])(I,f,m,!1,null,null,null)),j=M.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"login"}},[a("div",{attrs:{id:"login-box"}},[a("div",{attrs:{id:"login-tips"}},[a("span",{attrs:{id:"to-login"}},[e._v("Login")]),a("span",{attrs:{id:"to-regist"},on:{click:e.toRegist}},[e._v("Regist")]),a("span",{attrs:{id:"to-login-border"}})]),a("el-form",{ref:"formLogin",attrs:{"label-width":"55px",model:e.formLabelLogin,rules:e.ruleLogin}},[a("i",{staticClass:"fa fa-user-circle",attrs:{"aria-hidden":"true"}}),a("el-form-item",{attrs:{label:"",prop:"email"}},[a("el-input",{attrs:{placeholder:"Email"},model:{value:e.formLabelLogin.email,callback:function(t){e.$set(e.formLabelLogin,"email",t)},expression:"formLabelLogin.email"}})],1),a("i",{staticClass:"fa fa-key",attrs:{"aria-hidden":"true"}}),a("el-form-item",{attrs:{label:"",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.formLabelLogin.password,callback:function(t){e.$set(e.formLabelLogin,"password",t)},expression:"formLabelLogin.password"}})],1),a("i",{staticClass:"fa fa-codepen",attrs:{"aria-hidden":"true"}}),a("el-form-item",{attrs:{label:"",prop:"code"}},[a("el-input",{attrs:{placeholder:"VerifyCode"},model:{value:e.formLabelLogin.code,callback:function(t){e.$set(e.formLabelLogin,"code",t)},expression:"formLabelLogin.code"}})],1),a("el-form-item",[a("img",{attrs:{src:this.codeImgUrl,alt:""}}),a("a",{attrs:{id:"codeChange"},on:{click:e.changeCodeImg}},[e._v("看不清？换一个")])]),a("el-form-item",[a("el-button",{staticClass:"button-handle",on:{click:e.handleLogin}},[e._v("Log On")])],1),a("a",{attrs:{id:"pswForget"},on:{click:e.forgetPassWord}},[e._v("忘记密码？")])],1)],1)])},P=[],D={data:function(){return{formLabelLogin:{email:"",password:"",code:""},ruleLogin:{email:[{type:"email",required:!0,message:"请输入正确的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},codeImgUrl:"http://39.108.108.227:9527/cd/user/createCode",api:"http://39.108.108.227:9527"}},methods:{changeCodeImg:function(){var e=Math.ceil(10*Math.random());this.codeImgUrl="http://39.108.108.227:9527/cd/user/createCode?"+e},forgetPassWord:function(){this.$message({message:"此功能暂未开放",type:"warning"})},toRegist:function(){this.showLogin=!1,this.$router.push({path:"/regist"})},handleLogin:function(){var e=this,t="formLogin";this.$refs[t].validate((function(t){console.log(e.formLabelLogin.code),t&&e.$axios({url:e.api+"/cd/user/login",method:"post",data:{email:e.formLabelLogin.email,password:e.formLabelLogin.password,verifyCode:e.formLabelLogin.code}}).then((function(t){if(console.log(t),1==t.data.success){var a={data:t.data.data,time:Date.now(),expire:216e5};localStorage.setItem("token",JSON.stringify(a)),e.$router.push({path:"/main"})}else e.$message({message:t.data.message,type:"warning"}),e.changeCodeImg(),e.$router.push({path:"/login"})}))}))}},created:function(){this.changeCodeImg()}},T=D,B=(a("4fde"),Object(d["a"])(T,E,P,!1,null,null,null)),N=B.exports,H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"login"}},[a("div",{attrs:{id:"regist-box"}},[a("div",{attrs:{id:"login-tips"}},[a("span",{attrs:{id:"to-login"},on:{click:e.toLogin}},[e._v("Login")]),a("span",{attrs:{id:"to-regist"}},[e._v("Regist")]),a("span",{attrs:{id:"to-regist-border"}})]),a("el-form",{ref:"formRegist",attrs:{"label-width":"55px",model:e.formLabelRegist,rules:e.ruleRegist}},[a("i",{staticClass:"fa fa-envelope-o",attrs:{"aria-hidden":"true"}}),a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{ref:"formEmail",attrs:{placeholder:"Email"},model:{value:e.formLabelRegist.email,callback:function(t){e.$set(e.formLabelRegist,"email",t)},expression:"formLabelRegist.email"}})],1),a("i",{staticClass:"fa fa-user-circle-o",attrs:{"aria-hidden":"true"}}),a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{attrs:{placeholder:"Username"},model:{value:e.formLabelRegist.username,callback:function(t){e.$set(e.formLabelRegist,"username",t)},expression:"formLabelRegist.username"}})],1),a("i",{staticClass:"fa fa-key",attrs:{"aria-hidden":"true"}}),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"Password"},model:{value:e.formLabelRegist.password,callback:function(t){e.$set(e.formLabelRegist,"password",t)},expression:"formLabelRegist.password"}})],1),a("i",{staticClass:"fa fa-key",attrs:{"aria-hidden":"true"}}),a("el-form-item",{attrs:{prop:"passcheck"}},[a("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"PassCheck"},model:{value:e.formLabelRegist.passcheck,callback:function(t){e.$set(e.formLabelRegist,"passcheck",t)},expression:"formLabelRegist.passcheck"}})],1),a("i",{staticClass:"fa fa-codepen",attrs:{"aria-hidden":"true"}}),a("el-form-item",{attrs:{prop:"code"}},[a("el-input",{attrs:{id:"code-Input",placeholder:"VerifyCode"},model:{value:e.formLabelRegist.code,callback:function(t){e.$set(e.formLabelRegist,"code",t)},expression:"formLabelRegist.code"}})],1),a("el-button",{attrs:{id:"send-button",disabled:e.disabledCode},on:{click:e.sendCode}},[e._v(e._s(e.codeButtonText))]),a("el-form-item",[a("el-button",{staticClass:"button-handle",on:{click:e.handleRegist}},[e._v("Regist")])],1)],1)],1)])},A=[],U=(a("f471"),{data:function(){var e=this,t=function(t,a,i){""===a?i(new Error("请输入密码")):(""!==e.formLabelRegist.pswcheck&&e.$refs.formRegist.validateField("passcheck"),i())},a=function(t,a,i){""===a?i(new Error("请再次输入密码")):a!==e.formLabelRegist.password?(i(new Error("两次输入密码不一致!")),console.log(a)):i()},i=function(t,a,i){""===a?i(new Error("请输入邮箱")):e.$axios({url:"http://39.108.108.227:9527/cd/user/validEmail/"+a,method:"get"}).then((function(e){console.log(e),"操作成功"==e.data.message?i():i(new Error("该邮箱已注册"))}))},o=function(t,a,i){""===a?i(new Error("请输入用户名")):e.$axios({url:"http://39.108.108.227:9527/cd/user/validUsername/"+a,method:"get"}).then((function(e){"操作成功"==e.data.message?i():i(new Error("该用户名已存在"))}))};return{formLabelRegist:{email:"",password:"",passcheck:"",code:"",username:""},ruleRegist:{email:[{type:"email",required:!0,validator:i,trigger:"blur"}],username:[{required:!0,validator:o,trigger:"blur"}],password:[{required:!0,validator:t,trigger:"blur"}],passcheck:[{required:!0,validator:a,trigger:"blur"}]},codeImgUrl:"http://39.108.108.227:9527/cd/user/createCode",codeButtonText:"Send",disabledCode:!1,api:"http://39.108.108.227:9527"}},methods:{changeCodeImg:function(){var e=Math.ceil(10*Math.random());this.codeImgUrl="http://39.108.108.227:9527/cd/user/createCode?"+e},forgetPassWord:function(){this.$message({message:"此功能暂未开放",type:"warning"})},toLogin:function(){this.showLogin=!0,this.$router.push({path:"/"})},handleRegist:function(){var e=this,t="formEmail";this.$refs[t].validate((function(t){t&&e.$axios({url:"http://39.108.108.227:9527/cd/user/register",method:"post",data:{code:e.formLabelRegist.code,email:e.formLabelRegist.email,password:e.formLabelRegist.password,username:e.formLabelRegist.username}}).then((function(t){console.log(t.data.success),t.data.success?(e.$message({message:"注册成功",type:"success"}),e.$router.push({path:"/"})):e.$message({message:t.data.message,type:"warning"})}))}))},sendCode:function(){var e=this,t="formRegist";this.$refs[t].validate((function(t){if(t){e.$axios({url:"http://39.108.108.227:9527/cd/user/getCode/"+e.formLabelRegist.email,method:"get"}),e.disabledCode=!0;var a=60;e.codeButtonText=a+"s";var i=e,o=setInterval((function(){0==a?(i.codeButtonText="Send",i.disabledCode=!1,clearInterval(o)):(a--,i.codeButtonText=a+"s")}),1e3)}}))}}}),z=U,q=(a("f206"),Object(d["a"])(z,H,A,!1,null,null,null)),J=q.exports,K={},W=Object(d["a"])(K,i,o,!1,null,null,null),V=W.exports;s["default"].use(h["a"]);var Y=[{path:"/main",name:"Main",component:j},{path:"/",name:"Login",component:N,beforeEnter:function(e,t,a){if(localStorage.getItem("token")){var i=localStorage.getItem("token");i=JSON.parse(i);var o=Date.now()-i.time;console.log(o),o>=i.expire?(localStorage.removeItem("token"),alert("用户登录已过期"),a()):a("/main")}else a()}},{path:"/regist",name:"Regist",component:J},{path:"/share",name:"Share",component:V}],G=new h["a"]({mode:"history",base:"/",routes:Y}),Q=G,X=a("2f62");s["default"].use(X["a"]);var Z=!0,ee=!0,te="",ae=[0],ie=[],oe=[],se=new X["a"].Store({state:{data:ie,fileposition:ae,allowClick:Z,allowHover:ee,Formername:te,selection:oe},getters:{},mutations:{addKey:function(){for(var e=0;e<this.state.data.length;e++)s["default"].set(this.state.data[e],"hover",!1),s["default"].set(this.state.data[e],"edit",!1)}},actions:{},modules:{}}),re=a("5c96"),ne=a.n(re),le=(a("0fae"),a("1f54"),a("499a"),a("bc3a")),ce=a.n(le),de={getDate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate();a<=9&&(a="0"+a),i<=9&&(i="0"+i);var o=t+"-"+a+"-"+i;return o}},ue={api:de};ce.a.defaults.withCredentials=!0,s["default"].config.productionTip=!1,s["default"].use(ne.a,ue),s["default"].prototype.$axios=ce.a,ce.a.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t=JSON.parse(t),!e.headers.hasOwnProperty("token")&&t&&(e.headers.token=t.data),e}),(function(e){return Promise.reject(e)})),new s["default"]({router:Q,store:se,render:function(e){return e(p)}}).$mount("#app")},f206:function(e,t,a){"use strict";var i=a("3cd0"),o=a.n(i);o.a}});
//# sourceMappingURL=app.04a1a446.js.map